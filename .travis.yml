dist: xenial
language: python
environement:
  - ENVIRONMENT=test
  - HOST_HTTP_PORT=8000

services:
  - docker

before_install:
  - docker build -t bang_central .

script:
  - docker-compose run web python manage.py test

deploy:
  # Master
  - provider: script
    script: bash scripts/deploy.sh master
    on:
      branch: master
  # Stage
  - provider: script
    script: bash scripts/deploy.sh stage
    on:
      branch: stage
